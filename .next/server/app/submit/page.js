(()=>{var e={};e.id=369,e.ids=[369],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1241:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>o.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>x,tree:()=>c});var r=s(482),a=s(9108),n=s(2563),o=s.n(n),i=s(8300),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);s.d(t,l);let c=["",{children:["submit",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,1522)),"C:\\Users\\ณวิธบุญยะรัตน์\\Desktop\\Next.js\\4.Prasobpai\\app\\submit\\page.js"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,311)),"C:\\Users\\ณวิธบุญยะรัตน์\\Desktop\\Next.js\\4.Prasobpai\\app\\layout.js"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9361,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\ณวิธบุญยะรัตน์\\Desktop\\Next.js\\4.Prasobpai\\app\\submit\\page.js"],u="/submit/page",p={require:s,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/submit/page",pathname:"/submit",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},1572:(e,t,s)=>{Promise.resolve().then(s.bind(s,6640))},6640:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var r=s(5344),a=s(7853),n=s(3729),o=s(8428),i=s(9873),l=s(8987),c=s(1312),d=s(2594),u=s(6983),p=s(8331);function x(){let e=(0,o.useRouter)(),[t,s]=(0,n.useState)(!1),[x,m]=(0,n.useState)(null),[b,f]=(0,n.useState)({title:"",category:"มรสุมชีวิต",severity:5,content:""}),g={มรสุมชีวิต:"crisis",ภัยรายวัน:"daily",ขำแห้ง:"funny",คู่มือรอด:"guide"};(0,n.useEffect)(()=>{(async()=>{let{data:{user:e}}=await d.supabase.auth.getUser();e&&m(e)})()},[]);let h=e=>{let{name:t,value:s}=e.target;f(e=>({...e,[t]:s}))},y=async t=>{t.preventDefault(),s(!0);let r=g[b.category];try{let{data:{user:t}}=await d.supabase.auth.getUser();if(!t){a.default.fire({title:"กรุณาเข้าสู่ระบบ",text:"ต้องเข้าสู่ระบบก่อนโพสต์เรื่องราว",icon:"warning",confirmButtonText:"ไปหน้าเข้าสู่ระบบ",confirmButtonColor:"#0f172a"}).then(t=>{t.isConfirmed&&e.push("/login")}),s(!1);return}let n=await fetch("/api/slugify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:b.title,category:r})}),{slug:o}=await n.json(),{error:i}=await d.supabase.from("stories").insert([{title:b.title,category:r,severity_level:parseInt(b.severity),content:b.content,user_id:t.id,slug:o||`story-${Date.now()}`}]);if(i)throw i;await a.default.fire({title:"โพสต์สำเร็จ!",text:"เรื่องราวของคุณถูกแชร์เรียบร้อยแล้ว",icon:"success",confirmButtonText:"กลับหน้าแรก",confirmButtonColor:"#0f172a"}),e.push("/")}catch(e){console.error("Error adding story:",e),a.default.fire({title:"เกิดข้อผิดพลาด",text:e.message,icon:"error",confirmButtonText:"ตกลง",confirmButtonColor:"#ef4444"})}finally{s(!1)}};return(0,r.jsxs)("div",{className:"min-h-screen bg-[#fffbf0] font-sans selection:bg-amber-200 selection:text-slate-900",children:[r.jsx(i.default,{}),r.jsx("div",{className:"max-w-4xl mx-auto px-4 py-8 md:py-12 mt-20 md:mt-0 pb-24 md:pb-0",children:(0,r.jsxs)("div",{className:"bg-white p-6 md:p-8 rounded-xl border-4 border-slate-900 shadow-[4px_4px_0px_0px_rgba(251,191,36,1)] relative",children:[(0,r.jsxs)("h2",{className:"text-2xl font-black text-slate-900 mb-2 flex items-center gap-2",children:[r.jsx(c.Z,{className:"text-red-500"})," เขียนเรื่องใหม่"]}),(0,r.jsxs)("form",{className:"space-y-6 mt-6",onSubmit:y,children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"หัวข้อเรื่อง (ขอแบบพีคๆ)"}),r.jsx("input",{type:"text",name:"title",value:b.title,onChange:h,placeholder:"เช่น เดินตกท่อต่อหน้าคนที่แอบชอบ...",className:"w-full p-3 border-2 border-slate-300 rounded-lg focus:border-slate-900 focus:outline-none bg-slate-50 text-sm",required:!0})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"หมวดหมู่"}),(0,r.jsxs)("select",{name:"category",value:b.category,onChange:h,className:"w-full p-3 border-2 border-slate-300 rounded-lg focus:border-slate-900 focus:outline-none bg-slate-50 text-sm",children:[r.jsx("option",{children:"มรสุมชีวิต"}),r.jsx("option",{children:"ภัยรายวัน"}),r.jsx("option",{children:"ขำแห้ง"}),r.jsx("option",{children:"คู่มือรอด"})]})]}),r.jsx("div",{children:r.jsx(u.Z,{value:b.severity,onChange:h,name:"severity"})})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"เล่าเหตุการณ์"}),r.jsx(p.Z,{content:b.content,onChange:e=>{f(t=>({...t,content:e}))},userId:x?.id})]}),r.jsx("button",{type:"submit",disabled:t,className:"w-full bg-slate-900 text-amber-400 font-bold py-3 rounded-lg border-2 border-transparent hover:border-amber-400 shadow-lg transform active:scale-95 transition-transform disabled:opacity-50",children:t?"กำลังโพสต์...":"โพสต์เลย (เตือนภัยเพื่อนมนุษย์)"})]})]})}),r.jsx(l.Z,{})]})}},1522:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>a,default:()=>o});let r=(0,s(6843).createProxy)(String.raw`C:\Users\ณวิธบุญยะรัตน์\Desktop\Next.js\4.Prasobpai\app\submit\page.js`),{__esModule:a,$$typeof:n}=r,o=r.default},1312:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(4285).Z)("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[638,901,727,567,130,154,843],()=>s(1241));module.exports=r})();