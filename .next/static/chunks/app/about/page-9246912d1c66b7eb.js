(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[301],{5399:function(e,t,s){Promise.resolve().then(s.bind(s,473)),Promise.resolve().then(s.bind(s,8246)),Promise.resolve().then(s.t.bind(s,5250,23))},473:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var a=s(3827),r=s(4090),l=s(8792),n=s(7907),i=s(6943),d=s(9628),o=s(3688),c=s(6942),x=s(8198),u=s(4116),m=s(2677),f=s(1705);function h(){var e,t,s;let[h,b]=(0,r.useState)(!0),[p,v]=(0,r.useState)(0),[j,y]=(0,r.useState)(null),g=(0,n.usePathname)();(0,r.useEffect)(()=>{i.supabase.auth.getSession().then(e=>{var t;let{data:{session:s}}=e;y(null!==(t=null==s?void 0:s.user)&&void 0!==t?t:null)});let{data:{subscription:e}}=i.supabase.auth.onAuthStateChange((e,t)=>{var s;y(null!==(s=null==t?void 0:t.user)&&void 0!==s?s:null)});return()=>e.unsubscribe()},[]);let w=async()=>{await i.supabase.auth.signOut(),window.location.href="/login"};return(0,r.useEffect)(()=>{let e=()=>{let e=window.scrollY;e>p&&e>50?b(!1):b(!0),v(e)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[p]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("nav",{className:"hidden md:block sticky top-0 z-50 bg-slate-900 text-white shadow-lg border-b-4 border-amber-400",children:(0,a.jsx)("div",{className:"max-w-6xl mx-auto px-4",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsxs)(l.default,{href:"/",className:"flex items-center space-x-2 cursor-pointer transform hover:-rotate-2 transition-transform",children:[(0,a.jsx)("div",{className:"bg-amber-400 text-slate-900 p-2 rounded-lg font-black text-xl border-2 border-white",children:"PRASOBPAI"}),(0,a.jsx)("span",{className:"font-bold text-lg text-amber-100",children:"ประสบภัย.คอม"})]}),(0,a.jsxs)("div",{className:"flex space-x-6 items-center",children:[(0,a.jsx)(l.default,{href:"/",className:"hover:text-amber-400 font-medium ".concat("/"===g?"text-amber-400 underline decoration-wavy underline-offset-4":""),children:"ศูนย์บรรเทาทุกข์"}),(0,a.jsx)(l.default,{href:"/submit",className:"hover:text-amber-400 font-medium ".concat("/submit"===g?"text-amber-400 underline decoration-wavy underline-offset-4":""),children:"แจ้งเหตุฉุกเฉิน"}),(0,a.jsx)(l.default,{href:"/about",className:"hover:text-amber-400 font-medium ".concat("/about"===g?"text-amber-400 underline decoration-wavy underline-offset-4":""),children:"เกี่ยวกับเรา"}),j?(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)(l.default,{href:"/profile/edit",className:"flex items-center gap-2 hover:text-amber-400",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-slate-700 border border-white flex items-center justify-center overflow-hidden",children:(0,a.jsx)("img",{src:(null===(e=j.user_metadata)||void 0===e?void 0:e.avatar_url)||"https://api.dicebear.com/7.x/avataaars/svg?seed=".concat(j.email),alt:"Profile"})}),(0,a.jsx)("span",{className:"text-sm font-medium",children:(null===(t=j.user_metadata)||void 0===t?void 0:t.username)||"User"})]}),(0,a.jsx)("button",{onClick:w,className:"text-red-400 hover:text-red-300",title:"Logout",children:(0,a.jsx)(d.Z,{size:20})})]}):(0,a.jsx)(l.default,{href:"/login",className:"bg-white text-slate-900 px-4 py-2 rounded-lg font-bold hover:bg-amber-400 transition-colors",children:"เข้าสู่ระบบ"})]})]})})}),(0,a.jsxs)("div",{className:"md:hidden fixed top-0 left-0 right-0 z-50 transition-transform duration-300 ".concat(h?"translate-y-0":"-translate-y-full"),children:[(0,a.jsxs)("div",{className:"bg-slate-900 text-white px-4 py-3 flex justify-between items-center shadow-md",children:[(0,a.jsx)("div",{className:"flex items-center gap-2",children:j?(0,a.jsx)(l.default,{href:"/profile/edit",children:(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-slate-700 border border-slate-500 flex items-center justify-center overflow-hidden",children:(0,a.jsx)("img",{src:(null===(s=j.user_metadata)||void 0===s?void 0:s.avatar_url)||"https://api.dicebear.com/7.x/avataaars/svg?seed=".concat(j.email),alt:"Profile"})})}):(0,a.jsx)(l.default,{href:"/login",children:(0,a.jsx)(o.Z,{className:"text-amber-400"})})}),(0,a.jsx)("div",{className:"font-black text-lg text-amber-400 tracking-wide",children:"PRASOBPAI"}),(0,a.jsx)("div",{className:"flex items-center gap-3",children:(0,a.jsx)(c.Z,{size:22,className:"text-white"})})]}),(0,a.jsx)("div",{className:"bg-slate-800 text-slate-300 px-2 py-2 overflow-x-auto no-scrollbar flex items-center gap-6 shadow-lg",children:["ภาพรวม","ประสบการณ์","เกร็ดความรู้","แลกเครดิตความซวย","ร้านค้าแก้เคล็ด"].map((e,t)=>(0,a.jsx)("span",{className:"whitespace-nowrap text-sm font-medium px-2 pb-1 border-b-2 ".concat(0===t?"text-amber-400 border-amber-400":"border-transparent"),children:e},t))})]}),(0,a.jsxs)("div",{className:"md:hidden fixed bottom-0 left-0 right-0 z-50 bg-white border-t border-slate-200 px-4 py-2 flex justify-between items-end shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)] pb-safe",children:[(0,a.jsxs)(l.default,{href:"/",className:"flex flex-col items-center gap-1 w-1/5 ".concat("/"===g?"text-slate-900":"text-slate-400"),children:[(0,a.jsx)(x.Z,{size:24,strokeWidth:"/"===g?3:2}),(0,a.jsx)("span",{className:"text-[10px] font-bold",children:"หน้าแรก"})]}),(0,a.jsxs)("button",{className:"flex flex-col items-center gap-1 w-1/5 text-slate-400 hover:text-slate-900",children:[(0,a.jsx)(u.Z,{size:24}),(0,a.jsx)("span",{className:"text-[10px] font-bold",children:"บอร์ด"})]}),(0,a.jsxs)("div",{className:"relative w-1/5 flex justify-center",children:[(0,a.jsx)(l.default,{href:"/submit",className:"absolute -top-8 bg-slate-900 text-amber-400 p-4 rounded-full shadow-lg border-4 border-white transform hover:scale-105 transition-transform",children:(0,a.jsx)(m.Z,{size:28,strokeWidth:3})}),(0,a.jsx)("span",{className:"text-[10px] font-bold mt-8 text-slate-900",children:"โพสต์"})]}),(0,a.jsxs)("button",{className:"flex flex-col items-center gap-1 w-1/5 text-slate-400 hover:text-slate-900",children:[(0,a.jsx)(f.Z,{size:24}),(0,a.jsx)("span",{className:"text-[10px] font-bold",children:"แจ้งเตือน"})]}),(0,a.jsxs)(l.default,{href:"/profile/edit",className:"flex flex-col items-center gap-1 w-1/5 ".concat("/profile/edit"===g?"text-slate-900":"text-slate-400"),children:[(0,a.jsx)(o.Z,{size:24,strokeWidth:"/profile/edit"===g?3:2}),(0,a.jsx)("span",{className:"text-[10px] font-bold",children:"ฉัน"})]})]})]})}},8246:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return n}});var a=s(3827),r=s(4090);let l=(0,s(20).Z)("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);function n(){var e;let[t,s]=(0,r.useState)({dailyVisitors:0,avgSeverity:0,severityLabel:"..."}),[n,i]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{let e=async()=>{try{let e=await fetch("/api/stats"),t=await e.json();void 0!==t.dailyVisitors&&s(t)}catch(e){console.error("Failed to fetch stats:",e)}finally{i(!1)}};e();let t=setInterval(e,6e4);return()=>clearInterval(t)},[]),(0,a.jsxs)("div",{className:"bg-[#0f172a] relative rounded-2xl p-8 shadow-xl border border-slate-700 flex flex-col md:flex-row items-center justify-between gap-8 md:gap-16 text-center transform hover:scale-[1.01] transition-transform duration-500",children:[(0,a.jsxs)("div",{className:"absolute -top-5 left-1/2 -translate-x-1/2 bg-[#0f172a] px-4 py-1 rounded-full border border-slate-700 flex items-center gap-2 text-amber-400 font-bold shadow-lg whitespace-nowrap",children:[(0,a.jsx)(l,{size:20,className:"animate-pulse"})," สถิติความซวยเรียลไทม์"]}),(0,a.jsxs)("div",{className:"flex-1 w-full md:border-r border-slate-700 md:pr-8",children:[n?(0,a.jsx)("div",{className:"h-16 w-32 bg-slate-800 animate-pulse rounded mx-auto mb-2"}):(0,a.jsx)("div",{className:"text-5xl md:text-6xl font-black text-white mb-2 tracking-tighter",children:t.dailyVisitors.toLocaleString()}),(0,a.jsx)("div",{className:"text-slate-400 font-medium text-sm md:text-base",children:"จำนวนผู้ประสบภัยวันนี้"})]}),(0,a.jsxs)("div",{className:"flex-1 w-full md:pl-8",children:[n?(0,a.jsx)("div",{className:"h-16 w-32 bg-slate-800 animate-pulse rounded mx-auto mb-2"}):(0,a.jsx)("div",{className:"text-5xl md:text-6xl font-black mb-2 tracking-tighter ".concat("วิกฤต"===(e=t.severityLabel)?"text-red-500":"ปานกลาง"===e?"text-orange-400":"เล็กน้อย"===e?"text-yellow-400":"text-green-400"),children:t.severityLabel}),(0,a.jsx)("div",{className:"text-slate-400 font-medium text-sm md:text-base",children:"ระดับความซวยเฉลี่ย"})]})]})}},6943:function(e,t,s){"use strict";s.r(t),s.d(t,{supabase:function(){return n}});var a=s(2066);let r="https://dpkktxiiavunivqvkdol.supabase.co",l="sb_publishable_IP-OB42MoH1AMIhVS8wX-Q_Sr6btW_1";if(!r||!l)throw Error("Missing Supabase Environment Variables");let n=(0,a.eI)(r,l)},7907:function(e,t,s){"use strict";var a=s(5313);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},1705:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(20).Z)("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]])},4116:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(20).Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},8198:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(20).Z)("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]])},9628:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(20).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},2677:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(20).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},6942:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(20).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},3688:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(20).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])}},function(e){e.O(0,[66,862,971,69,744],function(){return e(e.s=5399)}),_N_E=e.O()}]);