(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3898:function(e,t,s){Promise.resolve().then(s.bind(s,6510)),Promise.resolve().then(s.bind(s,3631)),Promise.resolve().then(s.bind(s,473)),Promise.resolve().then(s.t.bind(s,5250,23))},6510:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return S}});var a=s(3827),l=s(4090),r=s(7376),n=s(5401),i=s(3507),o=s(8732),d=s(6211),c=s(8904),x=s(6581),m=s(2198),u=s(5024),h=s(8406),f=s(4923),b=s(3180),p=s(7535),g=s(8792),v=s(3411),j=s.n(v),w=s(6943),y=s(320);let N=e=>e<=2?"bg-green-500":e<=4?"bg-yellow-500":e<=6?"bg-orange-500":e<=8?"bg-red-500":"bg-purple-600",_=e=>e<=2?"text-green-500":e<=4?"text-yellow-500":e<=6?"text-orange-500":e<=8?"text-red-500":"text-purple-600",z=e=>{switch(e){case"crisis":return(0,a.jsx)(n.Z,{size:20});case"daily":return(0,a.jsx)(i.Z,{size:20});case"funny":return(0,a.jsx)(o.Z,{size:20});case"guide":return(0,a.jsx)(d.Z,{size:20});default:return(0,a.jsx)(r.Z,{size:20})}},k=[{id:"all",label:"รวมมิตร"},{id:"crisis",label:"มรสุมชีวิต"},{id:"daily",label:"ภัยรายวัน"},{id:"funny",label:"ขำแห้ง"},{id:"guide",label:"คู่มือรอด"}];function C(e){var t;let{story:s,currentUserId:r,currentUserRole:n,onDelete:i}=e,[o,d]=(0,l.useState)(!1),c=(0,l.useRef)(null);(0,l.useEffect)(()=>{function e(e){c.current&&!c.current.contains(e.target)&&d(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);let v=r&&s.user_id===r,C=s.id.toString().startsWith("mock-"),Z=async()=>{if((await j().fire({title:"แน่ใจนะวิ?",text:"ลบแล้วกู้คืนไม่ได้นะ จะลบความพังนี้จริงๆ หรอ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#0f172a",confirmButtonText:"ลบเลย",cancelButtonText:"เก็บไว้ก่อน"})).isConfirmed)try{let{error:e}=await w.supabase.from("stories").delete().eq("id",s.id);if(e)throw e;await j().fire("ลบเรียบร้อย!","ความพังนี้ถูกลบออกจากสารบบแล้ว","success"),i&&i(s.id)}catch(e){console.error("Error deleting story:",e),j().fire("เกิดข้อผิดพลาด","ลบไม่ได้ ลองใหม่อีกทีนะ","error")}};return(0,a.jsxs)("div",{className:"bg-white rounded-xl border-2 border-slate-900 shadow-[4px_4px_0px_0px_rgba(0,0,0,0.1)] md:shadow-[6px_6px_0px_0px_rgba(0,0,0,0.2)] hover:translate-y-[2px] transition-all flex flex-col relative group",children:[(v||"admin"===n)&&!C&&(0,a.jsxs)("div",{className:"absolute top-2 right-2 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity z-10 bg-white/80 p-1 rounded-md backdrop-blur-sm",children:[(0,a.jsx)(g.default,{href:"/edit/".concat(s.id),children:(0,a.jsx)("button",{className:"w-8 h-8 rounded-full bg-amber-400 text-slate-900 flex items-center justify-center hover:bg-amber-500 transition-colors shadow-sm",title:"แก้ไข",children:(0,a.jsx)(b.GN,{icon:p.IwR,size:"xs"})})}),(0,a.jsx)("button",{onClick:Z,className:"w-8 h-8 rounded-full bg-red-100 text-red-600 flex items-center justify-center hover:bg-red-200 transition-colors shadow-sm",title:"ลบ",children:(0,a.jsx)(b.GN,{icon:p.$aW,size:"xs"})})]}),(0,a.jsxs)("div",{className:"p-4 md:p-5 pb-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-md text-[10px] font-bold border border-slate-900 ".concat("crisis"===s.category?"bg-blue-100 text-blue-800":"daily"===s.category?"bg-yellow-100 text-yellow-800":"funny"===s.category?"bg-orange-100 text-orange-800":"bg-green-100 text-green-800"),children:[z(s.category)," ",(null===(t=k.find(e=>e.id===s.category))||void 0===t?void 0:t.label)||"General"]}),(0,a.jsx)("span",{className:"text-slate-400 text-xs",children:s.time})]}),(0,a.jsx)(g.default,{href:"/story/".concat(s.slug||s.id),children:(0,a.jsx)("h3",{className:"text-lg md:text-xl font-bold text-slate-900 mb-2 leading-snug line-clamp-2 hover:text-amber-500 transition-colors cursor-pointer",children:s.title})}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)("div",{className:"w-6 h-6 rounded-full bg-slate-200 border border-slate-900 flex items-center justify-center overflow-hidden",children:(0,a.jsx)("img",{src:s.avatar||"https://api.dicebear.com/7.x/avataaars/svg?seed=".concat(s.author),alt:"avatar"})}),(0,a.jsx)("span",{className:"text-xs font-medium text-slate-600",children:s.author})]})]}),(0,a.jsxs)("div",{className:"px-4 md:px-5 mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs font-bold text-slate-500 mb-1",children:[(0,a.jsx)("span",{children:"ระดับความพัง:"}),(0,a.jsxs)("span",{className:_(s.severity),children:[s.severity,"/10"]})]}),(0,a.jsx)("div",{className:"w-full h-2 md:h-2.5 bg-slate-100 rounded-full border border-slate-300 overflow-hidden relative",children:(0,a.jsx)("div",{className:"h-full ".concat(N(s.severity)),style:{width:"".concat(10*s.severity,"%")}})})]}),(0,a.jsx)("div",{className:"px-4 md:px-5 pb-4 flex-grow group/content",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("div",{className:"relative h-24 overflow-hidden",children:[(0,a.jsx)("p",{className:"text-slate-700 text-sm leading-relaxed font-sans break-words whitespace-pre-line line-clamp-3",children:s.content.replace(/<[^>]+>/g,"")}),(0,a.jsx)("div",{className:"absolute bottom-0 left-0 w-full h-12 bg-gradient-to-t from-white to-transparent pointer-events-none"})]}),(0,a.jsx)("div",{className:"mt-2 text-right",children:(0,a.jsx)(g.default,{href:"/story/".concat(s.slug||s.id),children:(0,a.jsxs)("button",{className:"text-slate-900 font-bold text-sm hover:underline inline-flex items-center gap-1 text-amber-600 hover:text-amber-700 transition-colors",children:["อ่านต่อ... ",(0,a.jsx)(y.Z,{size:14})]})})})]})}),(0,a.jsxs)("div",{className:"bg-slate-50 p-3 md:px-5 md:py-3 border-t border-slate-100 flex justify-between items-center rounded-b-xl opacity-95",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{onClick:async()=>{if(!r){j().fire("เข้าสู่ระบบก่อนนะ","ต้องล็อกอินก่อนถึงจะส่งกำลังใจได้","warning");return}s.isLiked?await w.supabase.from("reactions").delete().match({story_id:s.id,user_id:r}):await w.supabase.from("reactions").insert({story_id:s.id,user_id:r,reaction_type:"hug"}),window.location.reload()},className:"flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs md:text-sm font-bold transition-all ".concat(s.isLiked?"bg-rose-100 text-rose-600":"text-slate-500 hover:bg-rose-50 hover:text-rose-600"),children:[(0,a.jsx)(x.Z,{size:18,className:s.isLiked?"fill-rose-500":""}),s.hugCount||0]}),(0,a.jsx)(g.default,{href:"/story/".concat(s.slug||s.id,"#comments"),children:(0,a.jsxs)("button",{className:"flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs md:text-sm font-bold text-slate-500 hover:bg-blue-50 hover:text-blue-600 transition-all",children:[(0,a.jsx)(m.Z,{size:18}),s.commentCount||0]})}),(0,a.jsxs)("div",{className:"flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs md:text-sm font-bold text-slate-400 hover:bg-slate-100 hover:text-slate-900 transition-all select-none cursor-default",title:"จำนวนคนอ่าน",children:[(0,a.jsx)(u.Z,{size:18}),s.viewCount||0]})]}),(0,a.jsxs)("div",{className:"relative",ref:c,children:[(0,a.jsx)("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-0 h-0 pointer-events-none z-0 ".concat(o?"overflow-visible":"overflow-hidden"),children:o&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"absolute bg-orange-400 rounded-full w-2 h-2 animate-[ping_1s_ease-out_forwards]",style:{"--tw-translate-x":"-20px","--tw-translate-y":"-30px"}}),(0,a.jsx)("span",{className:"absolute bg-yellow-400 rounded-full w-2 h-2 animate-[ping_0.8s_ease-out_forwards_0.1s]",style:{top:"-10px",left:"10px"}}),(0,a.jsx)("span",{className:"absolute bg-red-400 rounded-full w-1.5 h-1.5 animate-[ping_1.2s_ease-out_forwards_0.05s]",style:{top:"-25px",left:"-15px"}}),(0,a.jsx)("span",{className:"absolute bg-white rounded-full w-1 h-1 animate-[ping_0.6s_ease-out_forwards_0.2s]",style:{top:"-35px",left:"5px"}}),(0,a.jsx)("span",{className:"absolute w-4 h-4 bg-gray-200/50 rounded-full blur-sm animate-[ping_1.5s_ease-out_forwards]",style:{top:"-10px"}})]})}),(0,a.jsxs)("button",{onClick:()=>d(!o),className:"group relative w-10 h-10 rounded-full flex items-center justify-center transition-all duration-300 z-20 ".concat(o?"bg-slate-800 text-white rotate-90 shadow-inner":"bg-gradient-to-tr from-emerald-400 to-teal-500 text-white shadow-lg shadow-emerald-500/30 hover:shadow-emerald-500/50 hover:-translate-y-0.5 hover:scale-110"),title:"แชร์ความพัง",children:[(0,a.jsx)(h.Z,{size:18,className:"transition-transform duration-500 ".concat(!o&&"group-hover:rotate-180")}),!o&&(0,a.jsx)("span",{className:"absolute -inset-1 rounded-full border border-emerald-500/30 opacity-0 group-hover:opacity-100 group-hover:animate-ping pointer-events-none"})]}),(0,a.jsx)("a",{href:"https://www.facebook.com/sharer/sharer.php?u=".concat(encodeURIComponent("".concat(window.location.origin,"/story/").concat(s.slug||s.id))),target:"_blank",rel:"noopener noreferrer",className:"absolute inset-0 flex items-center justify-center w-10 h-10 rounded-full bg-[#1877F2] text-white shadow-md transition-all duration-500 ease-elastic z-10 ".concat(o?"-translate-x-[45px] -translate-y-[45px] opacity-100 scale-100 rotate-0":"translate-x-0 translate-y-0 opacity-0 scale-50 rotate-[-45deg] pointer-events-none"),title:"แชร์ Facebook",children:(0,a.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"w-5 h-5",children:(0,a.jsx)("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})})}),(0,a.jsx)("a",{href:"https://social-plugins.line.me/lineit/share?url=".concat(encodeURIComponent("".concat(window.location.origin,"/story/").concat(s.slug||s.id))),target:"_blank",rel:"noopener noreferrer",className:"absolute inset-0 flex items-center justify-center w-10 h-10 rounded-full bg-[#06C755] text-white shadow-md transition-all duration-500 ease-elastic delay-75 z-10 ".concat(o?"-translate-y-[60px] opacity-100 scale-100 rotate-0":"translate-y-0 opacity-0 scale-50 rotate-[-45deg] pointer-events-none"),title:"แชร์ Line",children:(0,a.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"w-5 h-5",children:(0,a.jsx)("path",{d:"M24 10.304c0-5.369-5.383-9.738-12-9.738-6.616 0-12 4.369-12 9.738 0 4.814 4.269 8.846 10.036 9.608.391.084.922.258 1.057.592.121.3.079.736.038 1.029l-.159.957c-.048.286-.233 1.118 1.171.611 1.405-.506 7.567-4.453 7.567-4.453C22.222 17.5 24 14.126 24 10.304zm-14.505 2.7h-3.3a.566.566 0 0 1-.566-.566V8.166a.566.566 0 0 1 .566-.566h.566v3.266h2.734a.566.566 0 0 1 .566.566v.566a.566.566 0 0 1-.566.566zm2.4 0h-.566a.566.566 0 0 1-.566-.566V8.166a.566.566 0 0 1 .566-.566h.566a.566.566 0 0 1 .566.566v3.837a.566.566 0 0 1-.566.566zm4.834 0h-.566a.566.566 0 0 1-.566-.566v-2.07l-2.066 2.827a.555.555 0 0 1-.453.226h-.066a.566.566 0 0 1-.566-.566V8.166a.566.566 0 0 1 .566-.566h.566a.566.566 0 0 1 .566.566v2.07l2.066-2.827a.556.556 0 0 1 .453-.226h.066a.566.566 0 0 1 .566.566v3.837a.566.566 0 0 1-.566.566zm2.4-2.167h-2.734v-.566h2.734a.566.566 0 0 1 .566.566v.566a.566.566 0 1 1-.566 1.134h-2.734V8.166h2.734a.566.566 0 0 1 .566.566v.566a.566.566 0 0 1-.566.566z"})})}),(0,a.jsx)("button",{onClick:()=>{let e="".concat(window.location.origin,"/story/").concat(s.slug||s.id);navigator.clipboard.writeText(e),j().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0}).fire({icon:"success",title:"คัดลอกลิงก์แล้ว!"}),d(!1)},className:"absolute inset-0 flex items-center justify-center w-10 h-10 rounded-full bg-slate-500 text-white shadow-md transition-all duration-500 ease-elastic delay-150 z-10 ".concat(o?"translate-x-[45px] -translate-y-[45px] opacity-100 scale-100 rotate-0":"translate-x-0 translate-y-0 opacity-0 scale-50 rotate-[-45deg] pointer-events-none"),title:"คัดลอกลิงก์",children:(0,a.jsx)(f.Z,{size:20})})]})]})]})}let Z=[{id:"all",label:"รวมมิตร",icon:(0,a.jsx)(r.Z,{size:24}),color:"bg-slate-100"},{id:"crisis",label:"มรสุมชีวิต",icon:(0,a.jsx)(n.Z,{size:24}),color:"bg-blue-100 text-blue-600"},{id:"daily",label:"ภัยรายวัน",icon:(0,a.jsx)(i.Z,{size:24}),color:"bg-yellow-100 text-yellow-600"},{id:"funny",label:"ขำแห้ง",icon:(0,a.jsx)(o.Z,{size:24}),color:"bg-orange-100 text-orange-600"},{id:"guide",label:"คู่มือรอด",icon:(0,a.jsx)(d.Z,{size:24}),color:"bg-green-100 text-green-600"}];function S(){let[e,t]=(0,l.useState)("all"),[s,r]=(0,l.useState)("newest"),[i,o]=(0,l.useState)([]),[d,x]=(0,l.useState)(!0),[m,u]=(0,l.useState)(null);(0,l.useEffect)(()=>{(async()=>{let{data:{user:e}}=await w.supabase.auth.getUser();if(e){let{data:t}=await w.supabase.from("profiles").select("role").eq("id",e.id).single();u({...e,role:null==t?void 0:t.role})}})(),h()},[]);let h=async()=>{try{let e=w.supabase.from("stories").select("\n                    *,\n                profiles (\n                        display_name,\n                        avatar_url\n                    ),\n                    reactions (\n                        user_id,\n                        reaction_type\n                    ),\n                    comments (count),\n                    view_count\n                ").order("created_at",{ascending:!1}),{data:t,error:s}=await e;if(s)throw s;let a=t.map(e=>{var t,s,a,l;let r=m?e.reactions.find(e=>e.user_id===m.id):null,n=e.reactions.length;return{id:e.id,title:e.title,content:e.content,category:e.category,slug:e.slug,severity:e.severity_level,user_id:e.user_id,createdAt:e.created_at,time:new Date(e.created_at).toLocaleDateString("th-TH",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"}),author:(null===(t=e.profiles)||void 0===t?void 0:t.display_name)||"Anonymous",avatar:(null===(s=e.profiles)||void 0===s?void 0:s.avatar_url)||"https://api.dicebear.com/7.x/avataaars/svg?seed=Anonymous",isLiked:!!r,hugCount:n,commentCount:(null===(l=e.comments)||void 0===l?void 0:null===(a=l[0])||void 0===a?void 0:a.count)||0,viewCount:e.view_count||0}});o(a)}catch(e){console.error("Error fetching stories:",e)}finally{x(!1)}},f=e=>{o(t=>t.filter(t=>t.id!==e))},b=i.filter(t=>"all"===e||t.category===e),p=[...b].sort((e,t)=>"top_rated"===s?t.severity-e.severity:"most_liked"===s?t.hugCount-e.hugCount:new Date(t.createdAt)-new Date(e.createdAt));return(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8 md:py-12 pb-24 md:pb-12",children:[(0,a.jsxs)("div",{className:"md:hidden mb-8",children:[(0,a.jsx)("h3",{className:"font-bold text-slate-900 mb-3 px-1",children:"เลือกประเภทภัยพิบัติ"}),(0,a.jsx)("div",{className:"flex overflow-x-auto gap-4 pb-4 no-scrollbar snap-x",children:Z.map(s=>(0,a.jsxs)("div",{onClick:()=>t(s.id),className:"flex flex-col items-center gap-2 min-w-[80px] snap-start cursor-pointer group",children:[(0,a.jsxs)("div",{className:"w-14 h-14 rounded-2xl flex items-center justify-center border-2 ".concat(e===s.id?"bg-slate-900 text-amber-400 border-slate-900 shadow-md":"bg-white text-slate-600 border-slate-200"),children:[s.icon,"daily"===s.id&&(0,a.jsx)("div",{className:"absolute top-0 right-0 -mt-1 -mr-1 bg-red-500 text-white text-[8px] font-bold px-1.5 py-0.5 rounded-full border border-white",children:"แนะนำ"})]}),(0,a.jsx)("span",{className:"text-xs font-bold ".concat(e===s.id?"text-slate-900":"text-slate-500"),children:s.label})]},s.id))})]}),(0,a.jsxs)("div",{className:"hidden md:flex flex-col md:flex-row justify-between items-center mb-10 gap-4",children:[(0,a.jsx)("div",{className:"flex flex-wrap gap-3 justify-center md:justify-start",children:Z.map(s=>(0,a.jsxs)("button",{onClick:()=>t(s.id),className:"flex items-center gap-2 px-4 py-2 rounded-full font-bold border-2 transition-all ".concat(e===s.id?"bg-slate-900 text-amber-400 border-slate-900 shadow-md":"bg-white text-slate-700 border-slate-300 hover:border-slate-900 hover:text-slate-900"),children:[s.icon," ",s.label]},s.id))}),(0,a.jsxs)("div",{className:"relative group min-w-[160px]",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 right-3 flex items-center pointer-events-none text-slate-500",children:(0,a.jsx)(c.Z,{size:16})}),(0,a.jsxs)("select",{value:s,onChange:e=>r(e.target.value),className:"appearance-none w-full bg-white border-2 border-slate-200 text-slate-700 font-bold py-2 pl-4 pr-10 rounded-full cursor-pointer focus:outline-none focus:border-slate-900 hover:border-slate-400 transition-colors",children:[(0,a.jsx)("option",{value:"newest",children:"✨ มาใหม่ล่าสุด"}),(0,a.jsx)("option",{value:"top_rated",children:"\uD83D\uDD25 พังยับเยินสุด"}),(0,a.jsx)("option",{value:"most_liked",children:"❤️ ให้กำลังใจเยอะสุด"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4 md:hidden",children:[(0,a.jsx)(n.Z,{size:20,className:"text-slate-900"}),(0,a.jsx)("h2",{className:"text-lg font-black text-slate-900",children:"แลกเปลี่ยนประสบการณ์"})]}),d?(0,a.jsxs)("div",{className:"text-center py-20",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-slate-900 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-slate-500 font-bold",children:"กำลังโหลดความพัง..."})]}):0===b.length?(0,a.jsxs)("div",{className:"text-center py-20 bg-white rounded-xl border-2 border-dashed border-slate-300",children:[(0,a.jsx)("p",{className:"text-slate-500 font-bold text-lg",children:"ยังไม่มีเรื่องราวในหมวดหมู่นี้"}),(0,a.jsx)("p",{className:"text-slate-400 text-sm",children:"เป็นคนแรกที่เริ่มระบายเลย!"})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8",children:p.map(e=>(0,a.jsx)(C,{story:e,currentUserId:null==m?void 0:m.id,currentUserRole:null==m?void 0:m.role,onDelete:f},e.id))})]})}},3631:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return m}});var a=s(3827),l=s(4090),r=s(8792),n=s(3862),i=s(7376),o=s(9795),d=s(8630),c=s(6943);let x={id:"mock-1",title:"แฟนเก่าทักมาขอยืมเงิน...",content:'หลังจากเลิกกันไป 3 ปี อยู่ดีๆ ก็ทักมา "เตง สบายดีมั้ย พอดีเราเดือดร้อน..." นึกว่าจะมาง้อ ที่ไหนได้!!',category:"crisis"};function m(){var e;let[t,m]=(0,l.useState)([x]),[u,h]=(0,l.useState)(0),[f,b]=(0,l.useState)(!0);(0,l.useEffect)(()=>{(async()=>{try{let{data:e,error:t}=await c.supabase.from("stories").select("id, title, content, category, slug").order("view_count",{ascending:!1}).limit(3);if(t)throw t;e&&e.length>0&&m(e)}catch(e){console.error("Error fetching top stories:",e)}finally{b(!1)}})()},[]),(0,l.useEffect)(()=>{if(t.length<=1)return;let e=setInterval(()=>{h(e=>(e+1)%t.length)},5e3);return()=>clearInterval(e)},[t.length]);let p=()=>{h(e=>(e+1)%t.length)},g=()=>{h(e=>(e-1+t.length)%t.length)},v=t[u];return"undefined"!=typeof document?(e=>{let t=document.createElement("DIV");return t.innerHTML=e,t.textContent||t.innerText||""})(v.content).substring(0,150):v.content.substring(0,150),(0,a.jsxs)("div",{className:"bg-amber-50 border-b-4 border-slate-900 relative overflow-hidden mt-24 md:mt-0",children:[(0,a.jsx)("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:"radial-gradient(#444 1px, transparent 1px)",backgroundSize:"20px 20px"}}),(0,a.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-8 md:py-20 relative z-10 flex flex-col md:flex-row items-center gap-8",children:[(0,a.jsxs)("div",{className:"md:w-2/3",children:[(0,a.jsx)("div",{className:"inline-block bg-slate-900 text-amber-400 px-3 py-1 rounded-full text-sm font-bold mb-4 transform -rotate-1",children:"⚠ พื้นที่ระบาย ของคนดวงตก"}),(0,a.jsxs)("h1",{className:"text-3xl md:text-6xl font-black text-slate-900 mb-4 leading-tight",children:["เปลี่ยนเรื่อง ",(0,a.jsx)("span",{className:"text-red-600 inline-block transform rotate-2 bg-yellow-200 px-2",children:"ซวย"})," ",(0,a.jsx)("br",{}),"ให้เป็นเรื่อง ",(0,a.jsx)("span",{className:"text-green-700 inline-block transform -rotate-2 bg-green-200 px-2",children:"แชร์"})]}),(0,a.jsxs)("p",{className:"text-md md:text-xl text-slate-700 mb-6 font-medium",children:['ยินดีต้อนรับสู่ "ประสบภัย.คอม" พื้นที่ของคนดวงตก ',(0,a.jsx)("br",{className:"hidden md:block"}),"อย่าเก็บความพังไว้คนเดียว!"]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-4 hidden md:flex",children:(0,a.jsxs)("button",{onClick:async()=>{let{data:{session:e}}=await Promise.resolve().then(s.bind(s,6943)).then(e=>e.supabase.auth.getSession());e?window.location.href="/submit":(await Promise.resolve().then(s.t.bind(s,3411,23))).default.fire({title:"แจ้งเหตุฉุกเฉิน?",text:"กรุณาเข้าสู่ระบบก่อนแจ้งเหตุ",icon:"warning",showCancelButton:!0,confirmButtonColor:"#0f172a",cancelButtonColor:"#d33",confirmButtonText:"เข้าสู่ระบบ",cancelButtonText:"ยกเลิก"}).then(e=>{e.isConfirmed&&(window.location.href="/login")})},className:"bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-8 rounded-lg shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] border-2 border-black transform transition hover:-translate-y-1",children:[(0,a.jsx)(n.Z,{size:20,className:"inline mr-2"})," แจ้งเหตุฉุกเฉิน"]})})]}),(0,a.jsxs)("div",{className:"md:w-1/3 w-full relative group",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg border-2 border-slate-900 shadow-[12px_12px_0px_0px_rgba(0,0,0,1)] transform rotate-2 md:hover:rotate-0 transition-all duration-300 relative z-10 min-h-[200px] flex flex-col justify-between",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-3 border-b-2 border-dashed border-slate-200 pb-2",children:[(0,a.jsxs)("span",{className:"font-bold text-red-600 flex items-center gap-1 text-sm md:text-base animate-pulse",children:[(0,a.jsx)(i.Z,{size:16})," ภัยพิบัติยอดฮิต"]}),(0,a.jsx)("span",{className:"text-xs text-slate-500 font-bold px-2 py-0.5 bg-slate-100 rounded-full",children:"Top 3"})]}),(0,a.jsxs)("div",{className:"flex-grow",children:[(0,a.jsx)(r.default,{href:"mock-1"===v.id?"#":"/story/".concat(v.slug||v.id),children:(0,a.jsx)("h3",{className:"text-lg md:text-xl font-bold mb-2 leading-tight hover:text-amber-600 transition-colors line-clamp-2",children:v.title})}),(0,a.jsx)("p",{className:"text-slate-600 text-sm mb-4 line-clamp-3 leading-relaxed",children:null===(e=v.content)||void 0===e?void 0:e.replace(/<[^>]+>/g,"")})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center mt-2 pt-3 border-t border-slate-100",children:[(0,a.jsx)("div",{className:"flex gap-1",children:t.map((e,t)=>(0,a.jsx)("div",{className:"w-2 h-2 rounded-full transition-all ".concat(t===u?"bg-slate-900 w-4":"bg-slate-300")},t))}),t.length>1&&(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),g()},className:"p-1 hover:bg-slate-100 rounded-full text-slate-400 hover:text-slate-900 transition-colors",children:(0,a.jsx)(o.Z,{size:20})}),(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),p()},className:"p-1 hover:bg-slate-100 rounded-full text-slate-400 hover:text-slate-900 transition-colors",children:(0,a.jsx)(d.Z,{size:20})})]})]})]}),(0,a.jsx)("div",{className:"absolute top-2 right-2 w-full h-full bg-slate-900 rounded-lg -z-0 opacity-0 group-hover:opacity-10 transition-opacity"})]})]})]})}},473:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return f}});var a=s(3827),l=s(4090),r=s(8792),n=s(7907),i=s(6943),o=s(9628),d=s(3688),c=s(6942),x=s(8198),m=s(4116),u=s(2677),h=s(1705);function f(){var e,t,s;let[f,b]=(0,l.useState)(!0),[p,g]=(0,l.useState)(0),[v,j]=(0,l.useState)(null),w=(0,n.usePathname)();(0,l.useEffect)(()=>{i.supabase.auth.getSession().then(e=>{var t;let{data:{session:s}}=e;j(null!==(t=null==s?void 0:s.user)&&void 0!==t?t:null)});let{data:{subscription:e}}=i.supabase.auth.onAuthStateChange((e,t)=>{var s;j(null!==(s=null==t?void 0:t.user)&&void 0!==s?s:null)});return()=>e.unsubscribe()},[]);let y=async()=>{await i.supabase.auth.signOut(),window.location.href="/login"};return(0,l.useEffect)(()=>{let e=()=>{let e=window.scrollY;e>p&&e>50?b(!1):b(!0),g(e)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[p]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("nav",{className:"hidden md:block sticky top-0 z-50 bg-slate-900 text-white shadow-lg border-b-4 border-amber-400",children:(0,a.jsx)("div",{className:"max-w-6xl mx-auto px-4",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsxs)(r.default,{href:"/",className:"flex items-center space-x-2 cursor-pointer transform hover:-rotate-2 transition-transform",children:[(0,a.jsx)("div",{className:"bg-amber-400 text-slate-900 p-2 rounded-lg font-black text-xl border-2 border-white",children:"PRASOBPAI"}),(0,a.jsx)("span",{className:"font-bold text-lg text-amber-100",children:"ประสบภัย.คอม"})]}),(0,a.jsxs)("div",{className:"flex space-x-6 items-center",children:[(0,a.jsx)(r.default,{href:"/",className:"hover:text-amber-400 font-medium ".concat("/"===w?"text-amber-400 underline decoration-wavy underline-offset-4":""),children:"ศูนย์บรรเทาทุกข์"}),(0,a.jsx)(r.default,{href:"/submit",className:"hover:text-amber-400 font-medium ".concat("/submit"===w?"text-amber-400 underline decoration-wavy underline-offset-4":""),children:"แจ้งเหตุฉุกเฉิน"}),(0,a.jsx)(r.default,{href:"/about",className:"hover:text-amber-400 font-medium ".concat("/about"===w?"text-amber-400 underline decoration-wavy underline-offset-4":""),children:"เกี่ยวกับเรา"}),v?(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)(r.default,{href:"/profile/edit",className:"flex items-center gap-2 hover:text-amber-400",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-slate-700 border border-white flex items-center justify-center overflow-hidden",children:(0,a.jsx)("img",{src:(null===(e=v.user_metadata)||void 0===e?void 0:e.avatar_url)||"https://api.dicebear.com/7.x/avataaars/svg?seed=".concat(v.email),alt:"Profile"})}),(0,a.jsx)("span",{className:"text-sm font-medium",children:(null===(t=v.user_metadata)||void 0===t?void 0:t.username)||"User"})]}),(0,a.jsx)("button",{onClick:y,className:"text-red-400 hover:text-red-300",title:"Logout",children:(0,a.jsx)(o.Z,{size:20})})]}):(0,a.jsx)(r.default,{href:"/login",className:"bg-white text-slate-900 px-4 py-2 rounded-lg font-bold hover:bg-amber-400 transition-colors",children:"เข้าสู่ระบบ"})]})]})})}),(0,a.jsxs)("div",{className:"md:hidden fixed top-0 left-0 right-0 z-50 transition-transform duration-300 ".concat(f?"translate-y-0":"-translate-y-full"),children:[(0,a.jsxs)("div",{className:"bg-slate-900 text-white px-4 py-3 flex justify-between items-center shadow-md",children:[(0,a.jsx)("div",{className:"flex items-center gap-2",children:v?(0,a.jsx)(r.default,{href:"/profile/edit",children:(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-slate-700 border border-slate-500 flex items-center justify-center overflow-hidden",children:(0,a.jsx)("img",{src:(null===(s=v.user_metadata)||void 0===s?void 0:s.avatar_url)||"https://api.dicebear.com/7.x/avataaars/svg?seed=".concat(v.email),alt:"Profile"})})}):(0,a.jsx)(r.default,{href:"/login",children:(0,a.jsx)(d.Z,{className:"text-amber-400"})})}),(0,a.jsx)("div",{className:"font-black text-lg text-amber-400 tracking-wide",children:"PRASOBPAI"}),(0,a.jsx)("div",{className:"flex items-center gap-3",children:(0,a.jsx)(c.Z,{size:22,className:"text-white"})})]}),(0,a.jsx)("div",{className:"bg-slate-800 text-slate-300 px-2 py-2 overflow-x-auto no-scrollbar flex items-center gap-6 shadow-lg",children:["ภาพรวม","ประสบการณ์","เกร็ดความรู้","แลกเครดิตความซวย","ร้านค้าแก้เคล็ด"].map((e,t)=>(0,a.jsx)("span",{className:"whitespace-nowrap text-sm font-medium px-2 pb-1 border-b-2 ".concat(0===t?"text-amber-400 border-amber-400":"border-transparent"),children:e},t))})]}),(0,a.jsxs)("div",{className:"md:hidden fixed bottom-0 left-0 right-0 z-50 bg-white border-t border-slate-200 px-4 py-2 flex justify-between items-end shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)] pb-safe",children:[(0,a.jsxs)(r.default,{href:"/",className:"flex flex-col items-center gap-1 w-1/5 ".concat("/"===w?"text-slate-900":"text-slate-400"),children:[(0,a.jsx)(x.Z,{size:24,strokeWidth:"/"===w?3:2}),(0,a.jsx)("span",{className:"text-[10px] font-bold",children:"หน้าแรก"})]}),(0,a.jsxs)("button",{className:"flex flex-col items-center gap-1 w-1/5 text-slate-400 hover:text-slate-900",children:[(0,a.jsx)(m.Z,{size:24}),(0,a.jsx)("span",{className:"text-[10px] font-bold",children:"บอร์ด"})]}),(0,a.jsxs)("div",{className:"relative w-1/5 flex justify-center",children:[(0,a.jsx)(r.default,{href:"/submit",className:"absolute -top-8 bg-slate-900 text-amber-400 p-4 rounded-full shadow-lg border-4 border-white transform hover:scale-105 transition-transform",children:(0,a.jsx)(u.Z,{size:28,strokeWidth:3})}),(0,a.jsx)("span",{className:"text-[10px] font-bold mt-8 text-slate-900",children:"โพสต์"})]}),(0,a.jsxs)("button",{className:"flex flex-col items-center gap-1 w-1/5 text-slate-400 hover:text-slate-900",children:[(0,a.jsx)(h.Z,{size:24}),(0,a.jsx)("span",{className:"text-[10px] font-bold",children:"แจ้งเตือน"})]}),(0,a.jsxs)(r.default,{href:"/profile/edit",className:"flex flex-col items-center gap-1 w-1/5 ".concat("/profile/edit"===w?"text-slate-900":"text-slate-400"),children:[(0,a.jsx)(d.Z,{size:24,strokeWidth:"/profile/edit"===w?3:2}),(0,a.jsx)("span",{className:"text-[10px] font-bold",children:"ฉัน"})]})]})]})}},6943:function(e,t,s){"use strict";s.r(t),s.d(t,{supabase:function(){return n}});var a=s(2066);let l="https://dpkktxiiavunivqvkdol.supabase.co",r="sb_publishable_IP-OB42MoH1AMIhVS8wX-Q_Sr6btW_1";if(!l||!r)throw Error("Missing Supabase Environment Variables");let n=(0,a.eI)(l,r)}},function(e){e.O(0,[461,676,66,862,588,971,69,744],function(){return e(e.s=3898)}),_N_E=e.O()}]);