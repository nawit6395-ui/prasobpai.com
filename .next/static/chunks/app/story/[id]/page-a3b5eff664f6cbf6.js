(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[415],{6684:function(e,t,s){Promise.resolve().then(s.bind(s,2572))},2572:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return C}});var a=s(3827),r=s(4090);s(7907);var l=s(473),n=s(9859),i=s(6943),o=s(5401),c=s(3507),d=s(8732),x=s(6211),u=s(7376),h=s(3354),m=s(5024),f=s(20);let p=(0,f.Z)("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);var b=s(6581),v=s(2198),y=s(8406);let g=(0,f.Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),j=(0,f.Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var w=s(8792),N=s(3411),k=s.n(N),_=s(4923);function Z(e){let{story:t}=e;if(!t)return null;let s="".concat(window.location.origin,"/story/").concat(t.slug||t.id);return(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-slate-100 sticky top-24",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"แชร์บทความนี้"}),(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsxs)("a",{href:"https://www.facebook.com/sharer/sharer.php?u=".concat(encodeURIComponent(s)),target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full py-3 bg-[#1877F2] hover:bg-[#166fe5] text-white rounded-xl font-bold transition-all shadow-sm hover:shadow-md hover:-translate-y-0.5",children:[(0,a.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"w-5 h-5",children:(0,a.jsx)("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),"Facebook"]}),(0,a.jsxs)("a",{href:"https://social-plugins.line.me/lineit/share?url=".concat(encodeURIComponent(s)),target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full py-3 bg-[#06C755] hover:bg-[#05b34c] text-white rounded-xl font-bold transition-all shadow-sm hover:shadow-md hover:-translate-y-0.5",children:[(0,a.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"w-5 h-5",children:(0,a.jsx)("path",{d:"M24 10.304c0-5.369-5.383-9.738-12-9.738-6.616 0-12 4.369-12 9.738 0 4.814 4.269 8.846 10.036 9.608.391.084.922.258 1.057.592.121.3.079.736.038 1.029l-.159.957c-.048.286-.233 1.118 1.171.611 1.405-.506 7.567-4.453 7.567-4.453C22.222 17.5 24 14.126 24 10.304zm-14.505 2.7h-3.3a.566.566 0 0 1-.566-.566V8.166a.566.566 0 0 1 .566-.566h.566v3.266h2.734a.566.566 0 0 1 .566.566v.566a.566.566 0 0 1-.566.566zm2.4 0h-.566a.566.566 0 0 1-.566-.566V8.166a.566.566 0 0 1 .566-.566h.566a.566.566 0 0 1 .566.566v3.837a.566.566 0 0 1-.566.566zm4.834 0h-.566a.566.566 0 0 1-.566-.566v-2.07l-2.066 2.827a.555.555 0 0 1-.453.226h-.066a.566.566 0 0 1-.566-.566V8.166a.566.566 0 0 1 .566-.566h.566a.566.566 0 0 1 .566.566v2.07l2.066-2.827a.556.556 0 0 1 .453-.226h.066a.566.566 0 0 1 .566.566v3.837a.566.566 0 0 1-.566.566zm2.4-2.167h-2.734v-.566h2.734a.566.566 0 0 1 .566.566v.566a.566.566 0 1 1-.566 1.134h-2.734V8.166h2.734a.566.566 0 0 1 .566.566v.566a.566.566 0 0 1-.566.566z"})}),"Line"]}),(0,a.jsxs)("button",{onClick:()=>{navigator.clipboard.writeText(s),k().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0}).fire({icon:"success",title:"คัดลอกลิงก์แล้ว!"})},className:"flex items-center justify-center gap-2 w-full py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-bold transition-all",children:[(0,a.jsx)(_.Z,{size:20}),"คัดลอกลิงก์"]})]})]})}let z=e=>{let{size:t=24,...s}=e;return(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"3"}),(0,a.jsx)("circle",{cx:"19",cy:"5",r:"3"}),(0,a.jsx)("circle",{cx:"5",cy:"5",r:"3"}),(0,a.jsx)("circle",{cx:"19",cy:"19",r:"3"}),(0,a.jsx)("circle",{cx:"5",cy:"19",r:"3"})]})};function C(e){var t,s,f;let{params:N}=e,{id:_}=N,[C,M]=(0,r.useState)(null),[S,B]=(0,r.useState)([]),[q,H]=(0,r.useState)(""),[E,L]=(0,r.useState)(!0),[V,A]=(0,r.useState)(null),[P,T]=(0,r.useState)(!1),[I,R]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{let{data:{user:e}}=await i.supabase.auth.getUser();if(e){let{data:t}=await i.supabase.from("profiles").select("*").eq("id",e.id).single();A({...e,...t})}})()},[]),(0,r.useEffect)(()=>{},[]),(0,r.useEffect)(()=>{(async function(){try{var e,t,s;let{id:a}=N,r=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(a),l=i.supabase.from("stories").select("\n                    *,\n                    profiles (\n                        display_name,\n                        avatar_url\n                    ),\n                    reactions (\n                        reaction_type\n                    )\n                ");l=r?l.eq("id",a):l.eq("slug",a);let{data:n,error:o}=await l.single();if(o)throw o;(null==n?void 0:n.id)&&fetch("/api/view",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({story_id:n.id})}).catch(e=>console.error("View Count Error:",e));let c={hug:0,understand:0,dryLaugh:0};if(n.reactions&&n.reactions.forEach(e=>{"hug"===e.reaction_type&&c.hug++}),M({...n,author:(null===(e=n.profiles)||void 0===e?void 0:e.display_name)||"Anonymous",avatar:(null===(t=n.profiles)||void 0===t?void 0:t.avatar_url)||"https://api.dicebear.com/7.x/avataaars/svg?seed=".concat((null===(s=n.profiles)||void 0===s?void 0:s.display_name)||"Anonymous"),time:new Date(n.created_at).toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),reactionsCount:c}),null==n?void 0:n.id){let{data:e,error:t}=await i.supabase.from("comments").select("\n                            id,\n                            content,\n                            created_at,\n                            user_id,\n                            profiles (\n                                display_name,\n                                avatar_url\n                            )\n                        ").eq("story_id",n.id).order("created_at",{ascending:!0});t||B(e)}}catch(e){console.error("Error fetching data:",e)}finally{L(!1)}})()},[_]);let O=async e=>{if(e.preventDefault(),!V){k().fire({title:"เข้าสู่ระบบก่อนนะ",text:"ต้องล็อกอินก่อนถึงจะคอมเมนต์ได้ครับ",icon:"warning",confirmButtonText:"ไปหน้าล็อกอิน",showCancelButton:!0,cancelButtonText:"ไว้ก่อน"}).then(e=>{e.isConfirmed&&(window.location.href="/login")});return}if(q.trim()){T(!0);try{let{error:e}=await i.supabase.from("comments").insert({story_id:C.id,user_id:V.id,content:q.trim()});if(e)throw e;H("");let{data:t}=await i.supabase.from("comments").select("\n                    id, content, created_at, user_id,\n                    profiles (display_name, avatar_url)\n                ").eq("story_id",C.id).order("created_at",{ascending:!0});B(t||[])}catch(e){console.error("Comment Error:",e),k().fire("คอมเมนต์ไม่ได้","เกิดข้อผิดพลาด ลองใหม่อีกทีนะ","error")}finally{T(!1)}}},U=async e=>{if((await k().fire({title:"ลบความเห็น?",text:"แน่ใจนะว่าจะลบ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"ลบเลย"})).isConfirmed){let{error:t}=await i.supabase.from("comments").delete().eq("id",e);t||(B(t=>t.filter(t=>t.id!==e)),k().fire("ลบแล้ว","","success"))}};return E?(0,a.jsx)("div",{className:"min-h-screen bg-[#fffbf0] flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-slate-900"})}):C?(0,a.jsxs)("div",{className:"min-h-screen bg-white pb-24 md:pb-0 pt-16 md:pt-20 font-sans selection:bg-amber-200 selection:text-slate-900",children:[(0,a.jsx)(l.default,{}),(0,a.jsxs)("div",{className:"max-w-6xl mx-auto px-4 mt-8 flex flex-col lg:flex-row gap-8",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)(w.default,{href:"/",className:"mb-6 flex items-center gap-2 text-slate-500 hover:text-slate-900 font-bold transition-colors inline-block",children:[(0,a.jsx)(h.Z,{size:20})," กลับหน้าแรก"]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-bold border border-slate-900 mb-3 ".concat("crisis"===C.category?"bg-blue-100 text-blue-800":"daily"===C.category?"bg-yellow-100 text-yellow-800":"funny"===C.category?"bg-orange-100 text-orange-800":"bg-green-100 text-green-800"),children:[(e=>{switch(e){case"crisis":return(0,a.jsx)(o.Z,{size:20});case"daily":return(0,a.jsx)(c.Z,{size:20});case"funny":return(0,a.jsx)(d.Z,{size:20});case"guide":return(0,a.jsx)(x.Z,{size:20});default:return(0,a.jsx)(u.Z,{size:20})}})(C.category)," ",C.category]}),(0,a.jsx)("h1",{className:"text-3xl md:text-4xl font-black text-slate-900 leading-tight mb-4",children:C.title}),(0,a.jsxs)("div",{className:"flex justify-between items-center border-b border-slate-100 pb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-slate-200 border border-slate-900 flex items-center justify-center overflow-hidden",children:(0,a.jsx)("img",{src:C.avatar,alt:C.author})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-bold text-slate-900",children:C.author}),(0,a.jsx)("div",{className:"text-xs text-slate-500",children:C.time})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 text-slate-500 text-sm font-bold",children:[(0,a.jsx)(m.Z,{size:16})," ",C.view_count||0]}),(0,a.jsx)("button",{className:"text-slate-400 hover:text-slate-900",children:(0,a.jsx)(p,{size:24})})]})]})]}),(0,a.jsxs)("div",{className:"mb-8 bg-slate-50 p-4 rounded-xl border border-slate-100",children:[(0,a.jsxs)("div",{className:"flex justify-between items-end mb-2",children:[(0,a.jsx)("span",{className:"text-sm font-bold text-slate-600",children:"ระดับความพังพินาศ"}),(0,a.jsxs)("span",{className:"text-xl font-black ".concat(C.severity_level>7?"text-red-600":"text-slate-900"),children:[C.severity_level,"/10"]})]}),(0,a.jsx)("div",{className:"w-full h-4 bg-slate-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full ".concat((f=C.severity_level)<=3?"bg-yellow-400":f<=7?"bg-orange-500":"bg-red-600"," transition-all duration-1000 ease-out"),style:{width:"".concat(10*C.severity_level,"%")}})})]}),(0,a.jsx)("article",{className:"prose prose-slate max-w-none mb-12",children:(0,a.jsx)("div",{className:"text-lg text-slate-800 leading-8 font-medium font-sans [&_.spoiler]:bg-slate-800 [&_.spoiler]:text-transparent [&_.spoiler]:cursor-pointer [&_.spoiler]:rounded [&_.spoiler]:transition-all [&_.spoiler:hover]:bg-slate-700 [&_.spoiler.is-revealed]:bg-transparent [&_.spoiler.is-revealed]:text-inherit [&_.spoiler.is-revealed]:cursor-text",onClick:e=>{e.target.classList.contains("spoiler")&&e.target.classList.toggle("is-revealed")},dangerouslySetInnerHTML:{__html:C.content}})}),(0,a.jsxs)("div",{className:"sticky bottom-20 md:bottom-8 bg-white/90 backdrop-blur border border-slate-200 shadow-lg rounded-full p-2 flex justify-around items-center max-w-md mx-auto mb-12 z-40",children:[(0,a.jsxs)("button",{className:"flex flex-col items-center gap-1 p-2 text-slate-500 hover:text-rose-500 transition-colors",children:[(0,a.jsx)(b.Z,{size:24,className:(null===(t=C.reactionsCount)||void 0===t?void 0:t.hug)>0?"fill-rose-100 text-rose-500":""}),(0,a.jsx)("span",{className:"text-xs font-bold",children:(null===(s=C.reactionsCount)||void 0===s?void 0:s.hug)||0})]}),(0,a.jsxs)("button",{onClick:()=>document.getElementById("comments").scrollIntoView({behavior:"smooth"}),className:"flex flex-col items-center gap-1 p-2 text-slate-500 hover:text-blue-500 transition-colors",children:[(0,a.jsx)(v.Z,{size:24}),(0,a.jsx)("span",{className:"text-xs font-bold",children:S.length})]}),(0,a.jsx)("div",{className:"w-px h-8 bg-slate-200"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute left-1/2 bottom-full -translate-x-1/2 w-0 h-0 pointer-events-none z-0 ".concat(I?"overflow-visible":"overflow-hidden"),children:I&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"absolute bg-orange-400 rounded-full w-2 h-2 animate-[ping_1s_ease-out_forwards]",style:{"--tw-translate-x":"-20px","--tw-translate-y":"-30px"}}),(0,a.jsx)("span",{className:"absolute bg-yellow-400 rounded-full w-2 h-2 animate-[ping_0.8s_ease-out_forwards_0.1s]",style:{top:"-10px",left:"10px"}}),(0,a.jsx)("span",{className:"absolute bg-red-400 rounded-full w-1.5 h-1.5 animate-[ping_1.2s_ease-out_forwards_0.05s]",style:{top:"-25px",left:"-15px"}}),(0,a.jsx)("span",{className:"absolute bg-white rounded-full w-1 h-1 animate-[ping_0.6s_ease-out_forwards_0.2s]",style:{top:"-35px",left:"5px"}}),(0,a.jsx)("span",{className:"absolute w-4 h-4 bg-gray-200/50 rounded-full blur-sm animate-[ping_1.5s_ease-out_forwards]",style:{top:"-10px"}})]})}),(0,a.jsxs)("button",{onClick:()=>R(!I),className:"relative z-20 flex flex-col items-center gap-1 p-2 transition-all duration-300 ".concat(I?"text-slate-900 scale-110":"text-slate-500 hover:text-slate-900"),children:[(0,a.jsx)(y.Z,{size:24,className:I?"rotate-90 transition-transform":"transition-transform"}),(0,a.jsx)("span",{className:"text-xs font-bold",children:"แชร์"})]}),(0,a.jsx)("a",{href:"https://www.facebook.com/sharer/sharer.php?u=".concat(encodeURIComponent(window.location.href)),target:"_blank",rel:"noopener noreferrer",className:"absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 flex items-center justify-center w-10 h-10 rounded-full bg-[#1877F2] text-white shadow-md transition-all duration-500 ease-elastic z-0 ".concat(I?"-translate-x-[55px] -translate-y-[45px] opacity-100 scale-100 rotate-0":"translate-x-[-50%] translate-y-[50%] opacity-0 scale-50 rotate-[-45deg] pointer-events-none"),title:"แชร์ Facebook",children:(0,a.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"w-5 h-5",children:(0,a.jsx)("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})})}),(0,a.jsx)("a",{href:"https://social-plugins.line.me/lineit/share?url=".concat(encodeURIComponent(window.location.href)),target:"_blank",rel:"noopener noreferrer",className:"absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 flex items-center justify-center w-10 h-10 rounded-full bg-[#06C755] text-white shadow-md transition-all duration-500 ease-elastic delay-75 z-0 ".concat(I?"-translate-y-[75px] opacity-100 scale-100 rotate-0":"translate-x-[-50%] translate-y-[50%] opacity-0 scale-50 rotate-[-45deg] pointer-events-none"),title:"แชร์ Line",children:(0,a.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"w-5 h-5",children:(0,a.jsx)("path",{d:"M24 10.304c0-5.369-5.383-9.738-12-9.738-6.616 0-12 4.369-12 9.738 0 4.814 4.269 8.846 10.036 9.608.391.084.922.258 1.057.592.121.3.079.736.038 1.029l-.159.957c-.048.286-.233 1.118 1.171.611 1.405-.506 7.567-4.453 7.567-4.453C22.222 17.5 24 14.126 24 10.304zm-14.505 2.7h-3.3a.566.566 0 0 1-.566-.566V8.166a.566.566 0 0 1 .566-.566h.566v3.266h2.734a.566.566 0 0 1 .566.566v.566a.566.566 0 0 1-.566.566zm2.4 0h-.566a.566.566 0 0 1-.566-.566V8.166a.566.566 0 0 1 .566-.566h.566a.566.566 0 0 1 .566.566v3.837a.566.566 0 0 1-.566.566zm4.834 0h-.566a.566.566 0 0 1-.566-.566v-2.07l-2.066 2.827a.555.555 0 0 1-.453.226h-.066a.566.566 0 0 1-.566-.566V8.166a.566.566 0 0 1 .566-.566h.566a.566.566 0 0 1 .566.566v2.07l2.066-2.827a.556.556 0 0 1 .453-.226h.066a.566.566 0 0 1 .566.566v3.837a.566.566 0 0 1-.566.566zm2.4-2.167h-2.734v-.566h2.734a.566.566 0 0 1 .566.566v.566a.566.566 0 1 1-.566 1.134h-2.734V8.166h2.734a.566.566 0 0 1 .566.566v.566a.566.566 0 0 1-.566.566z"})})}),(0,a.jsx)("button",{onClick:()=>{let e=window.location.href;navigator.clipboard.writeText(e),k().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3}).fire({icon:"success",title:"คัดลอกลิงก์แล้ว!"}),R(!1)},className:"absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 flex items-center justify-center w-10 h-10 rounded-full bg-slate-500 text-white shadow-md transition-all duration-500 ease-elastic delay-150 z-0 ".concat(I?"translate-x-[55px] -translate-y-[45px] opacity-100 scale-100 rotate-0":"translate-x-[-50%] translate-y-[50%] opacity-0 scale-50 rotate-[-45deg] pointer-events-none"),title:"คัดลอกลิงก์",children:(0,a.jsx)(y.Z,{size:20})})]})]}),(0,a.jsxs)("div",{id:"comments",className:"bg-white rounded-xl p-6 border border-slate-100 mb-12 scroll-mt-24 shadow-sm",children:[(0,a.jsxs)("h3",{className:"font-bold text-lg mb-6 flex items-center gap-2 text-slate-900 border-b border-slate-100 pb-4",children:["ความคิดเห็น ",(0,a.jsxs)("span",{className:"text-slate-400 text-sm font-normal",children:["(",S.length,")"]})]}),(0,a.jsxs)("form",{onSubmit:O,className:"mb-8 flex gap-3 items-center",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-orange-100 flex-shrink-0 overflow-hidden border border-orange-200 flex items-center justify-center text-orange-500",children:(null==V?void 0:V.avatar_url)?(0,a.jsx)("img",{src:V.avatar_url,alt:"Me",className:"w-full h-full object-cover"}):(0,a.jsx)(z,{size:20})}),(0,a.jsxs)("div",{className:"flex-grow relative",children:[(0,a.jsx)("input",{type:"text",value:q,onChange:e=>H(e.target.value),placeholder:V?"แสดงความคิดเห็นเพื่อให้กำลังใจ...":"เข้าสู่ระบบเพื่อแสดงความคิดเห็น",className:"w-full pl-4 pr-12 py-3 rounded-xl border border-slate-200 focus:border-slate-400 focus:ring-0 outline-none transition-all text-slate-600 placeholder:text-slate-400",disabled:P}),(0,a.jsx)("button",{type:"submit",disabled:!q.trim()||P,className:"absolute right-2 top-1/2 -translate-y-1/2 p-1.5 bg-slate-500 text-white rounded-lg hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:(0,a.jsx)(g,{size:16})})]})]}),(0,a.jsx)("div",{className:"space-y-6",children:0===S.length?(0,a.jsxs)("div",{className:"text-center py-12 flex flex-col items-center gap-3",children:[(0,a.jsx)("div",{className:"p-3 bg-orange-50 rounded-full text-orange-400 mb-2",children:(0,a.jsx)(z,{size:32})}),(0,a.jsx)("p",{className:"text-slate-400 font-medium",children:"ยังไม่มีความคิดเห็น เป็นคนแรกเลยไหม?"})]}):S.map(e=>{var t,s,r;let l=V&&V.id===e.user_id;return(0,a.jsxs)("div",{className:"flex gap-3 group",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-slate-200 flex-shrink-0 overflow-hidden border border-slate-100",children:(0,a.jsx)("img",{src:(null===(t=e.profiles)||void 0===t?void 0:t.avatar_url)||"https://api.dicebear.com/7.x/avataaars/svg?seed=".concat((null===(s=e.profiles)||void 0===s?void 0:s.display_name)||"User"),alt:"avatar"})}),(0,a.jsx)("div",{className:"flex-grow",children:(0,a.jsxs)("div",{className:"bg-slate-50 p-3 rounded-2xl rounded-tl-none relative group-hover:bg-slate-100 transition-colors",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,a.jsx)("span",{className:"font-bold text-sm text-slate-900",children:(null===(r=e.profiles)||void 0===r?void 0:r.display_name)||"Anonymous"}),(0,a.jsx)("span",{className:"text-[10px] text-slate-400",children:new Date(e.created_at).toLocaleDateString("th-TH",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})})]}),(0,a.jsx)("p",{className:"text-sm text-slate-600 leading-relaxed",children:e.content}),l&&(0,a.jsx)("button",{onClick:()=>U(e.id),className:"absolute -right-2 -top-2 bg-white border border-slate-200 text-red-400 p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:text-red-600 shadow-sm",title:"ลบ",children:(0,a.jsx)(j,{size:12})})]})})]},e.id)})})]})]}),(0,a.jsx)("div",{className:"hidden lg:block w-[320px] flex-shrink-0",children:(0,a.jsx)(Z,{story:C})})]}),(0,a.jsx)(n.Z,{})]}):(0,a.jsxs)("div",{className:"min-h-screen bg-[#fffbf0] flex flex-col items-center justify-center gap-4",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-slate-900",children:"ไม่พบเรื่องราวนี้"}),(0,a.jsx)(w.default,{href:"/",className:"px-6 py-2 bg-slate-900 text-amber-400 rounded-lg font-bold",children:"กลับหน้าหลัก"})]})}},9859:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var a=s(3827),r=s(8792);function l(){return(0,a.jsx)("footer",{className:"hidden md:block bg-slate-900 text-slate-400 py-12 border-t-8 border-amber-400",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto px-4 text-center flex flex-col md:flex-row justify-between items-center gap-4",children:[(0,a.jsx)("p",{children:"\xa9 2024 Prasobpai. All wrongs reserved."}),(0,a.jsxs)("div",{className:"flex flex-wrap justify-center gap-6 text-sm font-medium",children:[(0,a.jsx)(r.default,{href:"/about",className:"hover:text-amber-400 transition-colors",children:"เกี่ยวกับเรา"}),(0,a.jsx)(r.default,{href:"/",className:"hover:text-amber-400 transition-colors",children:"รวมเรื่องซวยรายวัน"}),(0,a.jsx)(r.default,{href:"/",className:"hover:text-amber-400 transition-colors",children:"บทความแนะนำ"}),(0,a.jsx)(r.default,{href:"/privacy",className:"hover:text-amber-400 transition-colors",children:"นโยบายความเป็นส่วนตัว"})]})]})})}},473:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return f}});var a=s(3827),r=s(4090),l=s(8792),n=s(7907),i=s(6943),o=s(9628),c=s(3688),d=s(6942),x=s(8198),u=s(4116),h=s(2677),m=s(1705);function f(){var e,t,s;let[f,p]=(0,r.useState)(!0),[b,v]=(0,r.useState)(0),[y,g]=(0,r.useState)(null),j=(0,n.usePathname)();(0,r.useEffect)(()=>{i.supabase.auth.getSession().then(e=>{var t;let{data:{session:s}}=e;g(null!==(t=null==s?void 0:s.user)&&void 0!==t?t:null)});let{data:{subscription:e}}=i.supabase.auth.onAuthStateChange((e,t)=>{var s;g(null!==(s=null==t?void 0:t.user)&&void 0!==s?s:null)});return()=>e.unsubscribe()},[]);let w=async()=>{await i.supabase.auth.signOut(),window.location.href="/login"};return(0,r.useEffect)(()=>{let e=()=>{let e=window.scrollY;e>b&&e>50?p(!1):p(!0),v(e)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[b]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("nav",{className:"hidden md:block sticky top-0 z-50 bg-slate-900 text-white shadow-lg border-b-4 border-amber-400",children:(0,a.jsx)("div",{className:"max-w-6xl mx-auto px-4",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsxs)(l.default,{href:"/",className:"flex items-center space-x-2 cursor-pointer transform hover:-rotate-2 transition-transform",children:[(0,a.jsx)("div",{className:"bg-amber-400 text-slate-900 p-2 rounded-lg font-black text-xl border-2 border-white",children:"PRASOBPAI"}),(0,a.jsx)("span",{className:"font-bold text-lg text-amber-100",children:"ประสบภัย.คอม"})]}),(0,a.jsxs)("div",{className:"flex space-x-6 items-center",children:[(0,a.jsx)(l.default,{href:"/",className:"hover:text-amber-400 font-medium ".concat("/"===j?"text-amber-400 underline decoration-wavy underline-offset-4":""),children:"ศูนย์บรรเทาทุกข์"}),(0,a.jsx)(l.default,{href:"/submit",className:"hover:text-amber-400 font-medium ".concat("/submit"===j?"text-amber-400 underline decoration-wavy underline-offset-4":""),children:"แจ้งเหตุฉุกเฉิน"}),(0,a.jsx)(l.default,{href:"/about",className:"hover:text-amber-400 font-medium ".concat("/about"===j?"text-amber-400 underline decoration-wavy underline-offset-4":""),children:"เกี่ยวกับเรา"}),y?(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)(l.default,{href:"/profile/edit",className:"flex items-center gap-2 hover:text-amber-400",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-slate-700 border border-white flex items-center justify-center overflow-hidden",children:(0,a.jsx)("img",{src:(null===(e=y.user_metadata)||void 0===e?void 0:e.avatar_url)||"https://api.dicebear.com/7.x/avataaars/svg?seed=".concat(y.email),alt:"Profile"})}),(0,a.jsx)("span",{className:"text-sm font-medium",children:(null===(t=y.user_metadata)||void 0===t?void 0:t.username)||"User"})]}),(0,a.jsx)("button",{onClick:w,className:"text-red-400 hover:text-red-300",title:"Logout",children:(0,a.jsx)(o.Z,{size:20})})]}):(0,a.jsx)(l.default,{href:"/login",className:"bg-white text-slate-900 px-4 py-2 rounded-lg font-bold hover:bg-amber-400 transition-colors",children:"เข้าสู่ระบบ"})]})]})})}),(0,a.jsxs)("div",{className:"md:hidden fixed top-0 left-0 right-0 z-50 transition-transform duration-300 ".concat(f?"translate-y-0":"-translate-y-full"),children:[(0,a.jsxs)("div",{className:"bg-slate-900 text-white px-4 py-3 flex justify-between items-center shadow-md",children:[(0,a.jsx)("div",{className:"flex items-center gap-2",children:y?(0,a.jsx)(l.default,{href:"/profile/edit",children:(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-slate-700 border border-slate-500 flex items-center justify-center overflow-hidden",children:(0,a.jsx)("img",{src:(null===(s=y.user_metadata)||void 0===s?void 0:s.avatar_url)||"https://api.dicebear.com/7.x/avataaars/svg?seed=".concat(y.email),alt:"Profile"})})}):(0,a.jsx)(l.default,{href:"/login",children:(0,a.jsx)(c.Z,{className:"text-amber-400"})})}),(0,a.jsx)("div",{className:"font-black text-lg text-amber-400 tracking-wide",children:"PRASOBPAI"}),(0,a.jsx)("div",{className:"flex items-center gap-3",children:(0,a.jsx)(d.Z,{size:22,className:"text-white"})})]}),(0,a.jsx)("div",{className:"bg-slate-800 text-slate-300 px-2 py-2 overflow-x-auto no-scrollbar flex items-center gap-6 shadow-lg",children:["ภาพรวม","ประสบการณ์","เกร็ดความรู้","แลกเครดิตความซวย","ร้านค้าแก้เคล็ด"].map((e,t)=>(0,a.jsx)("span",{className:"whitespace-nowrap text-sm font-medium px-2 pb-1 border-b-2 ".concat(0===t?"text-amber-400 border-amber-400":"border-transparent"),children:e},t))})]}),(0,a.jsxs)("div",{className:"md:hidden fixed bottom-0 left-0 right-0 z-50 bg-white border-t border-slate-200 px-4 py-2 flex justify-between items-end shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)] pb-safe",children:[(0,a.jsxs)(l.default,{href:"/",className:"flex flex-col items-center gap-1 w-1/5 ".concat("/"===j?"text-slate-900":"text-slate-400"),children:[(0,a.jsx)(x.Z,{size:24,strokeWidth:"/"===j?3:2}),(0,a.jsx)("span",{className:"text-[10px] font-bold",children:"หน้าแรก"})]}),(0,a.jsxs)("button",{className:"flex flex-col items-center gap-1 w-1/5 text-slate-400 hover:text-slate-900",children:[(0,a.jsx)(u.Z,{size:24}),(0,a.jsx)("span",{className:"text-[10px] font-bold",children:"บอร์ด"})]}),(0,a.jsxs)("div",{className:"relative w-1/5 flex justify-center",children:[(0,a.jsx)(l.default,{href:"/submit",className:"absolute -top-8 bg-slate-900 text-amber-400 p-4 rounded-full shadow-lg border-4 border-white transform hover:scale-105 transition-transform",children:(0,a.jsx)(h.Z,{size:28,strokeWidth:3})}),(0,a.jsx)("span",{className:"text-[10px] font-bold mt-8 text-slate-900",children:"โพสต์"})]}),(0,a.jsxs)("button",{className:"flex flex-col items-center gap-1 w-1/5 text-slate-400 hover:text-slate-900",children:[(0,a.jsx)(m.Z,{size:24}),(0,a.jsx)("span",{className:"text-[10px] font-bold",children:"แจ้งเตือน"})]}),(0,a.jsxs)(l.default,{href:"/profile/edit",className:"flex flex-col items-center gap-1 w-1/5 ".concat("/profile/edit"===j?"text-slate-900":"text-slate-400"),children:[(0,a.jsx)(c.Z,{size:24,strokeWidth:"/profile/edit"===j?3:2}),(0,a.jsx)("span",{className:"text-[10px] font-bold",children:"ฉัน"})]})]})]})}},6943:function(e,t,s){"use strict";s.r(t),s.d(t,{supabase:function(){return n}});var a=s(2066);let r="https://dpkktxiiavunivqvkdol.supabase.co",l="sb_publishable_IP-OB42MoH1AMIhVS8wX-Q_Sr6btW_1";if(!r||!l)throw Error("Missing Supabase Environment Variables");let n=(0,a.eI)(r,l)},7907:function(e,t,s){"use strict";var a=s(5313);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},7376:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(20).Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},3354:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(20).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},1705:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(20).Z)("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]])},5401:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(20).Z)("CloudRain",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]])},8732:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(20).Z)("Coffee",[["path",{d:"M17 8h1a4 4 0 1 1 0 8h-1",key:"jx4kbh"}],["path",{d:"M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z",key:"1bxrl0"}],["line",{x1:"6",x2:"6",y1:"2",y2:"4",key:"1cr9l3"}],["line",{x1:"10",x2:"10",y1:"2",y2:"4",key:"170wym"}],["line",{x1:"14",x2:"14",y1:"2",y2:"4",key:"1c5f70"}]])},5024:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(20).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},4116:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(20).Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},6581:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(20).Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},8198:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(20).Z)("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]])},6211:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(20).Z)("LifeBuoy",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]])},4923:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(20).Z)("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]])},9628:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(20).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},2198:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(20).Z)("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]])},2677:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(20).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},6942:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(20).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},8406:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(20).Z)("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]])},3688:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(20).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},3507:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(20).Z)("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]])}},function(e){e.O(0,[461,66,862,971,69,744],function(){return e(e.s=6684)}),_N_E=e.O()}]);